<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "c677667095f6133eee418c7e53615d05",
  "translation_date": "2025-08-24T21:29:02+00:00",
  "source_file": "4-manufacturing/lessons/2-check-fruit-from-device/pi-camera.md",
  "language_code": "zh"
}
-->
# æ•æ‰å›¾åƒ - æ ‘è“æ´¾

åœ¨æœ¬è¯¾ç¨‹çš„è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†ä¸ºæ ‘è“æ´¾æ·»åŠ ä¸€ä¸ªæ‘„åƒå¤´ä¼ æ„Ÿå™¨ï¼Œå¹¶ä»ä¸­è¯»å–å›¾åƒã€‚

## ç¡¬ä»¶

æ ‘è“æ´¾éœ€è¦ä¸€ä¸ªæ‘„åƒå¤´ã€‚

ä½ å°†ä½¿ç”¨çš„æ‘„åƒå¤´æ˜¯ [æ ‘è“æ´¾æ‘„åƒå¤´æ¨¡å—](https://www.raspberrypi.org/products/camera-module-v2/)ã€‚è¿™ä¸ªæ‘„åƒå¤´ä¸“ä¸ºæ ‘è“æ´¾è®¾è®¡ï¼Œé€šè¿‡æ ‘è“æ´¾ä¸Šçš„ä¸“ç”¨è¿æ¥å™¨è¿æ¥ã€‚

> ğŸ’ è¿™ä¸ªæ‘„åƒå¤´ä½¿ç”¨ [æ‘„åƒå¤´ä¸²è¡Œæ¥å£ï¼ˆCamera Serial Interfaceï¼‰ï¼Œä¸€ç§ç”±ç§»åŠ¨äº§ä¸šå¤„ç†å™¨æ¥å£è”ç›Ÿå¼€å‘çš„åè®®](https://wikipedia.org/wiki/Camera_Serial_Interface)ï¼Œç®€ç§° MIPI-CSIã€‚è¿™æ˜¯ä¸€ç§ä¸“ç”¨çš„å›¾åƒä¼ è¾“åè®®ã€‚

## è¿æ¥æ‘„åƒå¤´

æ‘„åƒå¤´å¯ä»¥é€šè¿‡ä¸€æ¡æ‰å¹³ç”µç¼†è¿æ¥åˆ°æ ‘è“æ´¾ã€‚

### ä»»åŠ¡ - è¿æ¥æ‘„åƒå¤´

![æ ‘è“æ´¾æ‘„åƒå¤´](../../../../translated_images/pi-camera-module.4278753c31bd6e757aa2b858be97d72049f71616278cefe4fb5abb485b40a078.zh.png)

1. å…³é—­æ ‘è“æ´¾çš„ç”µæºã€‚

1. å°†æ‘„åƒå¤´é™„å¸¦çš„æ‰å¹³ç”µç¼†è¿æ¥åˆ°æ‘„åƒå¤´ä¸Šã€‚ä¸ºæ­¤ï¼Œè½»è½»æ‹‰åŠ¨æ’åº§ä¸­çš„é»‘è‰²å¡‘æ–™å¤¹ï¼Œä½¿å…¶ç¨å¾®å¼¹å‡ºï¼Œç„¶åå°†ç”µç¼†æ»‘å…¥æ’åº§ï¼Œè“è‰²ä¸€é¢æœå‘é•œå¤´å¤–ä¾§ï¼Œé‡‘å±é’ˆè„šæ¡æœå‘é•œå¤´ã€‚æ’å…¥åˆ°ä½åï¼Œå°†é»‘è‰²å¡‘æ–™å¤¹æ¨å›åŸä½ã€‚

    ä½ å¯ä»¥åœ¨ [æ ‘è“æ´¾æ‘„åƒå¤´æ¨¡å—å…¥é—¨æ–‡æ¡£](https://projects.raspberrypi.org/en/projects/getting-started-with-picamera/2) ä¸­æ‰¾åˆ°ä¸€ä¸ªåŠ¨ç”»ï¼Œå±•ç¤ºå¦‚ä½•æ‰“å¼€å¤¹å­å¹¶æ’å…¥ç”µç¼†ã€‚

    ![æ‰å¹³ç”µç¼†æ’å…¥æ‘„åƒå¤´æ¨¡å—](../../../../translated_images/pi-camera-ribbon-cable.0bf82acd251611c21ac616f082849413e2b322a261d0e4f8fec344248083b07e.zh.png)

1. ä»æ ‘è“æ´¾ä¸Šç§»é™¤ Grove Base Hatã€‚

1. å°†æ‰å¹³ç”µç¼†ç©¿è¿‡ Grove Base Hat çš„æ‘„åƒå¤´æ’æ§½ã€‚ç¡®ä¿ç”µç¼†çš„è“è‰²ä¸€é¢æœå‘æ ‡æœ‰ **A0**ã€**A1** ç­‰çš„æ¨¡æ‹Ÿç«¯å£ã€‚

    ![æ‰å¹³ç”µç¼†ç©¿è¿‡ Grove Base Hat](../../../../translated_images/grove-base-hat-ribbon-cable.501fed202fcf73b11b2b68f6d246189f7d15d3e4423c572ddee79d77b4632b47.zh.png)

1. å°†æ‰å¹³ç”µç¼†æ’å…¥æ ‘è“æ´¾ä¸Šçš„æ‘„åƒå¤´ç«¯å£ã€‚åŒæ ·ï¼Œæ‹‰èµ·é»‘è‰²å¡‘æ–™å¤¹ï¼Œæ’å…¥ç”µç¼†ï¼Œç„¶åå°†å¤¹å­æ¨å›ã€‚ç”µç¼†çš„è“è‰²ä¸€é¢åº”æœå‘ USB å’Œä»¥å¤ªç½‘ç«¯å£ã€‚

    ![æ‰å¹³ç”µç¼†è¿æ¥åˆ°æ ‘è“æ´¾çš„æ‘„åƒå¤´æ’åº§](../../../../translated_images/pi-camera-socket-ribbon-cable.a18309920b11800911082ed7aa6fb28e6d9be3a022e4079ff990016cae3fca10.zh.png)

1. é‡æ–°å®‰è£… Grove Base Hatã€‚

## ç¼–ç¨‹æ‘„åƒå¤´

ç°åœ¨å¯ä»¥ä½¿ç”¨ [PiCamera](https://pypi.org/project/picamera/) Python åº“å¯¹æ ‘è“æ´¾è¿›è¡Œç¼–ç¨‹ä»¥ä½¿ç”¨æ‘„åƒå¤´ã€‚

### ä»»åŠ¡ - å¯ç”¨ä¼ ç»Ÿæ‘„åƒå¤´æ¨¡å¼

ä¸å¹¸çš„æ˜¯ï¼Œéšç€æ ‘è“æ´¾æ“ä½œç³»ç»Ÿ Bullseye çš„å‘å¸ƒï¼Œæ“ä½œç³»ç»Ÿé™„å¸¦çš„æ‘„åƒå¤´è½¯ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼Œé»˜è®¤æƒ…å†µä¸‹ PiCamera ä¸å†å·¥ä½œã€‚ç›®å‰æ­£åœ¨å¼€å‘ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œåä¸º PiCamera2ï¼Œä½†å°šæœªå‡†å¤‡å¥½ä½¿ç”¨ã€‚

ç›®å‰ï¼Œä½ å¯ä»¥å°†æ ‘è“æ´¾è®¾ç½®ä¸ºä¼ ç»Ÿæ‘„åƒå¤´æ¨¡å¼ï¼Œä»¥ä½¿ PiCamera å·¥ä½œã€‚æ‘„åƒå¤´æ’åº§é»˜è®¤ä¹Ÿæ˜¯ç¦ç”¨çš„ï¼Œä½†å¯ç”¨ä¼ ç»Ÿæ‘„åƒå¤´è½¯ä»¶ä¼šè‡ªåŠ¨å¯ç”¨æ’åº§ã€‚

1. å¯åŠ¨æ ‘è“æ´¾å¹¶ç­‰å¾…å…¶å®Œæˆå¯åŠ¨ã€‚

1. å¯åŠ¨ VS Codeï¼Œå¯ä»¥ç›´æ¥åœ¨æ ‘è“æ´¾ä¸Šè¿è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Remote SSH æ‰©å±•è¿æ¥ã€‚

1. åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

    ```sh
    sudo raspi-config nonint do_legacy 0
    sudo reboot
    ```

    è¿™å°†åˆ‡æ¢è®¾ç½®ä»¥å¯ç”¨ä¼ ç»Ÿæ‘„åƒå¤´è½¯ä»¶ï¼Œç„¶åé‡å¯æ ‘è“æ´¾ä»¥ä½¿è®¾ç½®ç”Ÿæ•ˆã€‚

1. ç­‰å¾…æ ‘è“æ´¾é‡å¯ï¼Œç„¶åé‡æ–°å¯åŠ¨ VS Codeã€‚

### ä»»åŠ¡ - ç¼–ç¨‹æ‘„åƒå¤´

å¯¹è®¾å¤‡è¿›è¡Œç¼–ç¨‹ã€‚

1. åœ¨ç»ˆç«¯ä¸­ï¼Œåœ¨ `pi` ç”¨æˆ·çš„ä¸»ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `fruit-quality-detector` çš„æ–°æ–‡ä»¶å¤¹ã€‚åœ¨æ­¤æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `app.py` çš„æ–‡ä»¶ã€‚

1. åœ¨ VS Code ä¸­æ‰“å¼€æ­¤æ–‡ä»¶å¤¹ã€‚

1. è¦ä¸æ‘„åƒå¤´äº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨ PiCamera Python åº“ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… Pip åŒ…ï¼š

    ```sh
    pip3 install picamera
    ```

1. å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°ä½ çš„ `app.py` æ–‡ä»¶ä¸­ï¼š

    ```python
    import io
    import time
    from picamera import PiCamera
    ```

    è¿™æ®µä»£ç å¯¼å…¥äº†ä¸€äº›éœ€è¦çš„åº“ï¼ŒåŒ…æ‹¬ `PiCamera` åº“ã€‚

1. åœ¨æ­¤ä»£ç ä¸‹æ–¹æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥åˆå§‹åŒ–æ‘„åƒå¤´ï¼š

    ```python
    camera = PiCamera()
    camera.resolution = (640, 480)
    camera.rotation = 0
    
    time.sleep(2)
    ```

    è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ª PiCamera å¯¹è±¡ï¼Œå¹¶å°†åˆ†è¾¨ç‡è®¾ç½®ä¸º 640x480ã€‚è™½ç„¶æ”¯æŒæ›´é«˜çš„åˆ†è¾¨ç‡ï¼ˆæœ€é«˜ 3280x2464ï¼‰ï¼Œä½†å›¾åƒåˆ†ç±»å™¨ä½¿ç”¨çš„å›¾åƒå°ºå¯¸è¦å°å¾—å¤šï¼ˆ227x227ï¼‰ï¼Œå› æ­¤æ— éœ€æ•è·å’Œå‘é€æ›´å¤§çš„å›¾åƒã€‚

    `camera.rotation = 0` è¡Œè®¾ç½®å›¾åƒçš„æ—‹è½¬è§’åº¦ã€‚æ‰å¹³ç”µç¼†ä»æ‘„åƒå¤´åº•éƒ¨è¿›å…¥ï¼Œä½†å¦‚æœä½ çš„æ‘„åƒå¤´æ—‹è½¬è¿‡ä»¥ä¾¿æ›´å®¹æ˜“å¯¹å‡†ä½ æƒ³è¦åˆ†ç±»çš„ç‰©å“ï¼Œåˆ™å¯ä»¥å°†æ­¤è¡Œæ›´æ”¹ä¸ºæ—‹è½¬çš„è§’åº¦ã€‚

    ![æ‘„åƒå¤´æ‚¬æŒ‚åœ¨é¥®æ–™ç½ä¸Šæ–¹](../../../../translated_images/pi-camera-upside-down.5376961ba31459883362124152ad6b823d5ac5fc14e85f317e22903bd681c2b6.zh.png)

    ä¾‹å¦‚ï¼Œå¦‚æœä½ å°†æ‰å¹³ç”µç¼†æ‚¬æŒ‚åœ¨æŸç‰©ä¸Šï¼Œä½¿å…¶ä½äºæ‘„åƒå¤´é¡¶éƒ¨ï¼Œåˆ™å°†æ—‹è½¬è®¾ç½®ä¸º 180ï¼š

    ```python
    camera.rotation = 180
    ```

    æ‘„åƒå¤´éœ€è¦å‡ ç§’é’Ÿå¯åŠ¨ï¼Œå› æ­¤æœ‰ `time.sleep(2)`ã€‚

1. åœ¨æ­¤ä»£ç ä¸‹æ–¹æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥å°†å›¾åƒæ•è·ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼š

    ```python
    image = io.BytesIO()
    camera.capture(image, 'jpeg')
    image.seek(0)
    ```

    è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ª `BytesIO` å¯¹è±¡æ¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ã€‚å›¾åƒä»¥ JPEG æ–‡ä»¶çš„å½¢å¼ä»æ‘„åƒå¤´è¯»å–å¹¶å­˜å‚¨åœ¨æ­¤å¯¹è±¡ä¸­ã€‚æ­¤å¯¹è±¡æœ‰ä¸€ä¸ªä½ç½®æŒ‡ç¤ºå™¨ï¼Œç”¨äºæŒ‡ç¤ºæ•°æ®ä¸­çš„å½“å‰ä½ç½®ï¼Œä»¥ä¾¿éœ€è¦æ—¶å¯ä»¥å°†æ›´å¤šæ•°æ®å†™å…¥æœ«å°¾ï¼Œå› æ­¤ `image.seek(0)` è¡Œå°†ä½ç½®ç§»å›èµ·å§‹ä½ç½®ï¼Œä»¥ä¾¿ç¨åå¯ä»¥è¯»å–æ‰€æœ‰æ•°æ®ã€‚

1. åœ¨æ­¤ä»£ç ä¸‹æ–¹æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥å°†å›¾åƒä¿å­˜åˆ°æ–‡ä»¶ï¼š

    ```python
    with open('image.jpg', 'wb') as image_file:
        image_file.write(image.read())
    ```

    è¿™æ®µä»£ç æ‰“å¼€ä¸€ä¸ªåä¸º `image.jpg` çš„æ–‡ä»¶è¿›è¡Œå†™å…¥ï¼Œç„¶åä» `BytesIO` å¯¹è±¡ä¸­è¯»å–æ‰€æœ‰æ•°æ®å¹¶å†™å…¥è¯¥æ–‡ä»¶ã€‚

    > ğŸ’ ä½ å¯ä»¥ç›´æ¥å°†å›¾åƒæ•è·åˆ°æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ `BytesIO` å¯¹è±¡ï¼Œåªéœ€å°†æ–‡ä»¶åä¼ é€’ç»™ `camera.capture` è°ƒç”¨å³å¯ã€‚ä½¿ç”¨ `BytesIO` å¯¹è±¡çš„åŸå› æ˜¯ç¨ååœ¨æœ¬è¯¾ç¨‹ä¸­ä½ å¯ä»¥å°†å›¾åƒå‘é€åˆ°å›¾åƒåˆ†ç±»å™¨ã€‚

1. å°†æ‘„åƒå¤´å¯¹å‡†æŸç‰©å¹¶è¿è¡Œæ­¤ä»£ç ã€‚

1. å›¾åƒå°†è¢«æ•è·å¹¶ä¿å­˜ä¸ºå½“å‰æ–‡ä»¶å¤¹ä¸­çš„ `image.jpg`ã€‚ä½ å°†åœ¨ VS Code çš„èµ„æºç®¡ç†å™¨ä¸­çœ‹åˆ°æ­¤æ–‡ä»¶ã€‚é€‰æ‹©è¯¥æ–‡ä»¶ä»¥æŸ¥çœ‹å›¾åƒã€‚å¦‚æœéœ€è¦æ—‹è½¬ï¼Œè¯·æ ¹æ®éœ€è¦æ›´æ–° `camera.rotation = 0` è¡Œå¹¶é‡æ–°æ‹æ‘„ç…§ç‰‡ã€‚

> ğŸ’ ä½ å¯ä»¥åœ¨ [code-camera/pi](../../../../../4-manufacturing/lessons/2-check-fruit-from-device/code-camera/pi) æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ­¤ä»£ç ã€‚

ğŸ˜€ ä½ çš„æ‘„åƒå¤´ç¨‹åºè¿è¡ŒæˆåŠŸï¼
