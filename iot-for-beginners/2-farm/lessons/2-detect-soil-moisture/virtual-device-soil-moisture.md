<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "2bf65f162bcebd35fbcba5fd245afac4",
  "translation_date": "2025-08-24T22:39:06+00:00",
  "source_file": "2-farm/lessons/2-detect-soil-moisture/virtual-device-soil-moisture.md",
  "language_code": "zh"
}
-->
# æµ‹é‡åœŸå£¤æ¹¿åº¦ - è™šæ‹Ÿç‰©è”ç½‘ç¡¬ä»¶

åœ¨æœ¬è¯¾çš„è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæ‚¨å°†ä¸ºè™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡æ·»åŠ ä¸€ä¸ªç”µå®¹å¼åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼Œå¹¶è¯»å–å…¶æ•°å€¼ã€‚

## è™šæ‹Ÿç¡¬ä»¶

è™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡å°†ä½¿ç”¨æ¨¡æ‹Ÿçš„ Grove ç”µå®¹å¼åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ã€‚è¿™ä½¿å¾—æœ¬å®éªŒä¸ä½¿ç”¨ Raspberry Pi å’Œç‰©ç† Grove ç”µå®¹å¼åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨çš„æ“ä½œä¿æŒä¸€è‡´ã€‚

åœ¨ç‰©ç†ç‰©è”ç½‘è®¾å¤‡ä¸­ï¼ŒåœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æ˜¯ä¸€ä¸ªç”µå®¹å¼ä¼ æ„Ÿå™¨ï¼Œé€šè¿‡æ£€æµ‹åœŸå£¤çš„ç”µå®¹æ¥æµ‹é‡åœŸå£¤æ¹¿åº¦ã€‚éšç€åœŸå£¤æ¹¿åº¦çš„å˜åŒ–ï¼Œç”µå®¹ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å½“åœŸå£¤æ¹¿åº¦å¢åŠ æ—¶ï¼Œç”µå‹ä¼šé™ä½ã€‚

è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿä¼ æ„Ÿå™¨ï¼Œå› æ­¤ä½¿ç”¨æ¨¡æ‹Ÿçš„ 10 ä½ ADC æ¥æŠ¥å‘Š 1-1,023 èŒƒå›´å†…çš„æ•°å€¼ã€‚

### å°†åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æ·»åŠ åˆ° CounterFit

è¦ä½¿ç”¨è™šæ‹ŸåœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° CounterFit åº”ç”¨ä¸­ã€‚

#### ä»»åŠ¡ - å°†åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æ·»åŠ åˆ° CounterFit

å°†åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æ·»åŠ åˆ° CounterFit åº”ç”¨ä¸­ã€‚

1. åœ¨æ‚¨çš„ç”µè„‘ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º `soil-moisture-sensor` çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `app.py` çš„å•ä¸€æ–‡ä»¶ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ª Python è™šæ‹Ÿç¯å¢ƒï¼Œå¹¶æ·»åŠ  CounterFit çš„ pip åŒ…ã€‚

    > âš ï¸ å¦‚æœéœ€è¦ï¼Œå¯ä»¥å‚è€ƒ[ç¬¬ 1 è¯¾ä¸­å…³äºåˆ›å»ºå’Œè®¾ç½® CounterFit Python é¡¹ç›®çš„è¯´æ˜](../../../1-getting-started/lessons/1-introduction-to-iot/virtual-device.md)ã€‚

1. ç¡®ä¿ CounterFit ç½‘é¡µåº”ç”¨æ­£åœ¨è¿è¡Œã€‚

1. åˆ›å»ºä¸€ä¸ªåœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼š

    1. åœ¨ *Sensors* é¢æ¿çš„ *Create sensor* æ¡†ä¸­ï¼Œç‚¹å‡» *Sensor type* ä¸‹æ‹‰æ¡†å¹¶é€‰æ‹© *Soil Moisture*ã€‚

    1. å°† *Units* ä¿æŒä¸º *NoUnits*ã€‚

    1. ç¡®ä¿ *Pin* è®¾ç½®ä¸º *0*ã€‚

    1. ç‚¹å‡» **Add** æŒ‰é’®ï¼Œåœ¨ Pin 0 ä¸Šåˆ›å»º *Soil Moisture* ä¼ æ„Ÿå™¨ã€‚

    ![åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨è®¾ç½®](../../../../translated_images/counterfit-create-soil-moisture-sensor.35266135a5e0ae68b29a684d7db0d2933a8098b2307d197f7c71577b724603aa.zh.png)

    åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨å°†è¢«åˆ›å»ºå¹¶æ˜¾ç¤ºåœ¨ä¼ æ„Ÿå™¨åˆ—è¡¨ä¸­ã€‚

    ![å·²åˆ›å»ºçš„åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨](../../../../translated_images/counterfit-soil-moisture-sensor.81742b2de0e9de60a3b3b9a2ff8ecc686d428eb6d71820f27a693be26e5aceee.zh.png)

## ç¼–å†™åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨åº”ç”¨ç¨‹åº

ç°åœ¨å¯ä»¥ä½¿ç”¨ CounterFit ä¼ æ„Ÿå™¨ç¼–å†™åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨åº”ç”¨ç¨‹åºã€‚

### ä»»åŠ¡ - ç¼–å†™åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨åº”ç”¨ç¨‹åº

ç¼–å†™åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨åº”ç”¨ç¨‹åºã€‚

1. ç¡®ä¿ `soil-moisture-sensor` åº”ç”¨å·²åœ¨ VS Code ä¸­æ‰“å¼€ã€‚

1. æ‰“å¼€ `app.py` æ–‡ä»¶ã€‚

1. åœ¨ `app.py` æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä»¥è¿æ¥åº”ç”¨åˆ° CounterFitï¼š

    ```python
    from counterfit_connection import CounterFitConnection
    CounterFitConnection.init('127.0.0.1', 5000)
    ```

1. åœ¨ `app.py` æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ä»¥å¯¼å…¥ä¸€äº›æ‰€éœ€çš„åº“ï¼š

    ```python
    import time
    from counterfit_shims_grove.adc import ADC
    ```

    `import time` è¯­å¥å¯¼å…¥äº† `time` æ¨¡å—ï¼Œè¯¥æ¨¡å—å°†åœ¨åç»­ä»»åŠ¡ä¸­ä½¿ç”¨ã€‚

    `from counterfit_shims_grove.adc import ADC` è¯­å¥å¯¼å…¥äº† `ADC` ç±»ï¼Œç”¨äºä¸è™šæ‹Ÿæ¨¡æ‹Ÿåˆ°æ•°å­—è½¬æ¢å™¨äº¤äº’ï¼Œè¯¥è½¬æ¢å™¨å¯ä»¥è¿æ¥åˆ° CounterFit ä¼ æ„Ÿå™¨ã€‚

1. åœ¨æ­¤ä»£ç ä¸‹æ–¹æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä»¥åˆ›å»º `ADC` ç±»çš„å®ä¾‹ï¼š

    ```python
    adc = ADC()
    ```

1. æ·»åŠ ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œä» Pin 0 çš„ ADC è¯»å–æ•°æ®å¹¶å°†ç»“æœå†™å…¥æ§åˆ¶å°ã€‚æ­¤å¾ªç¯å¯ä»¥åœ¨æ¯æ¬¡è¯»å–ä¹‹é—´ä¼‘çœ  10 ç§’ã€‚

    ```python
    while True:
        soil_moisture = adc.read(0)
        print("Soil moisture:", soil_moisture)
    
        time.sleep(10)
    ```

1. åœ¨ CounterFit åº”ç”¨ä¸­æ›´æ”¹åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨çš„å€¼ï¼Œè¯¥å€¼å°†è¢«åº”ç”¨ç¨‹åºè¯»å–ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼è¿›è¡Œæ›´æ”¹ï¼š

    * åœ¨åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨çš„ *Value* æ¡†ä¸­è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œç„¶åç‚¹å‡» **Set** æŒ‰é’®ã€‚æ‚¨è¾“å…¥çš„æ•°å­—å°†æ˜¯ä¼ æ„Ÿå™¨è¿”å›çš„å€¼ã€‚

    * å‹¾é€‰ *Random* å¤é€‰æ¡†ï¼Œå¹¶è¾“å…¥ *Min* å’Œ *Max* å€¼ï¼Œç„¶åç‚¹å‡» **Set** æŒ‰é’®ã€‚æ¯æ¬¡ä¼ æ„Ÿå™¨è¯»å–å€¼æ—¶ï¼Œå®ƒå°†è¯»å–ä¸€ä¸ªä»‹äº *Min* å’Œ *Max* ä¹‹é—´çš„éšæœºæ•°ã€‚

1. è¿è¡Œ Python åº”ç”¨ç¨‹åºã€‚æ‚¨å°†åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°åœŸå£¤æ¹¿åº¦æµ‹é‡å€¼ã€‚æ›´æ”¹ *Value* æˆ– *Random* è®¾ç½®ä»¥æŸ¥çœ‹å€¼çš„å˜åŒ–ã€‚

    ```text
    (.venv) âœ soil-moisture-sensor $ python app.py 
    Soil moisture: 615
    Soil moisture: 612
    Soil moisture: 498
    Soil moisture: 493
    Soil moisture: 490
    Soil Moisture: 388
    ```

> ğŸ’ æ‚¨å¯ä»¥åœ¨ [code/virtual-device](../../../../../2-farm/lessons/2-detect-soil-moisture/code/virtual-device) æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ­¤ä»£ç ã€‚

ğŸ˜€ æ‚¨çš„åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨ç¨‹åºè¿è¡ŒæˆåŠŸï¼
