<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "f8f541ee945545017a51aaf309aa37c3",
  "translation_date": "2025-08-24T22:18:50+00:00",
  "source_file": "2-farm/lessons/3-automated-plant-watering/virtual-device-relay.md",
  "language_code": "zh"
}
-->
# æ§åˆ¶ç»§ç”µå™¨ - è™šæ‹Ÿç‰©è”ç½‘ç¡¬ä»¶

åœ¨æœ¬èŠ‚è¯¾ç¨‹ä¸­ï¼Œæ‚¨å°†ä¸ºè™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡æ·»åŠ ä¸€ä¸ªç»§ç”µå™¨ï¼Œé™¤äº†åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨å¤–ï¼Œè¿˜å¯ä»¥æ ¹æ®åœŸå£¤æ¹¿åº¦æ°´å¹³æ¥æ§åˆ¶ç»§ç”µå™¨ã€‚

## è™šæ‹Ÿç¡¬ä»¶

è™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡å°†ä½¿ç”¨æ¨¡æ‹Ÿçš„ Grove ç»§ç”µå™¨ã€‚è¿™ä½¿å¾—æœ¬å®éªŒä¸ä½¿ç”¨å¸¦æœ‰ç‰©ç† Grove ç»§ç”µå™¨çš„ Raspberry Pi çš„æ“ä½œä¿æŒä¸€è‡´ã€‚

åœ¨ç‰©ç†ç‰©è”ç½‘è®¾å¤‡ä¸­ï¼Œç»§ç”µå™¨é€šå¸¸æ˜¯å¸¸å¼€å‹ç»§ç”µå™¨ï¼ˆå³å½“æ²¡æœ‰ä¿¡å·å‘é€åˆ°ç»§ç”µå™¨æ—¶ï¼Œè¾“å‡ºç”µè·¯æ˜¯æ–­å¼€çš„æˆ–æœªè¿æ¥çš„ï¼‰ã€‚è¿™ç§ç»§ç”µå™¨å¯ä»¥å¤„ç†é«˜è¾¾ 250V å’Œ 10A çš„è¾“å‡ºç”µè·¯ã€‚

### å°†ç»§ç”µå™¨æ·»åŠ åˆ° CounterFit

è¦ä½¿ç”¨è™šæ‹Ÿç»§ç”µå™¨ï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ° CounterFit åº”ç”¨ä¸­ã€‚

#### ä»»åŠ¡

å°†ç»§ç”µå™¨æ·»åŠ åˆ° CounterFit åº”ç”¨ã€‚

1. å¦‚æœå°šæœªæ‰“å¼€ï¼Œè¯·åœ¨ VS Code ä¸­æ‰“å¼€ä¸Šä¸€èŠ‚è¯¾ä¸­çš„ `soil-moisture-sensor` é¡¹ç›®ã€‚æ‚¨å°†åŸºäºæ­¤é¡¹ç›®è¿›è¡Œæ·»åŠ ã€‚

1. ç¡®ä¿ CounterFit ç½‘é¡µåº”ç”¨æ­£åœ¨è¿è¡Œã€‚

1. åˆ›å»ºä¸€ä¸ªç»§ç”µå™¨ï¼š

    1. åœ¨ *Actuators* é¢æ¿çš„ *Create actuator* æ¡†ä¸­ï¼Œç‚¹å‡» *Actuator type* ä¸‹æ‹‰æ¡†å¹¶é€‰æ‹© *Relay*ã€‚

    1. å°† *Pin* è®¾ç½®ä¸º *5*ã€‚

    1. ç‚¹å‡» **Add** æŒ‰é’®ï¼Œåœ¨ Pin 5 ä¸Šåˆ›å»ºç»§ç”µå™¨ã€‚

    ![ç»§ç”µå™¨è®¾ç½®](../../../../translated_images/counterfit-create-relay.fa7c40fd0f2f6afc33b35ea94fcb235085be4861e14e3fe6b9b7bcfc82d1c888.zh.png)

    ç»§ç”µå™¨å°†è¢«åˆ›å»ºå¹¶æ˜¾ç¤ºåœ¨æ‰§è¡Œå™¨åˆ—è¡¨ä¸­ã€‚

    ![åˆ›å»ºçš„ç»§ç”µå™¨](../../../../translated_images/counterfit-relay.bbf74c1dbdc8b9acd983367fcbd06703a402aefef6af54ddb28e11307ba8a12c.zh.png)

## ç¼–ç¨‹ç»§ç”µå™¨

ç°åœ¨å¯ä»¥ä¸ºåœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨åº”ç”¨ç¼–ç¨‹ä»¥ä½¿ç”¨è™šæ‹Ÿç»§ç”µå™¨ã€‚

### ä»»åŠ¡

ç¼–ç¨‹è™šæ‹Ÿè®¾å¤‡ã€‚

1. å¦‚æœå°šæœªæ‰“å¼€ï¼Œè¯·åœ¨ VS Code ä¸­æ‰“å¼€ä¸Šä¸€èŠ‚è¯¾ä¸­çš„ `soil-moisture-sensor` é¡¹ç›®ã€‚æ‚¨å°†åŸºäºæ­¤é¡¹ç›®è¿›è¡Œæ·»åŠ ã€‚

1. åœ¨ç°æœ‰çš„å¯¼å…¥ä»£ç ä¸‹æ–¹ï¼Œå°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ° `app.py` æ–‡ä»¶ä¸­ï¼š

    ```python
    from counterfit_shims_grove.grove_relay import GroveRelay
    ```

    æ­¤è¯­å¥ä» Grove Python shim åº“ä¸­å¯¼å…¥ `GroveRelay`ï¼Œä»¥ä¸è™šæ‹Ÿ Grove ç»§ç”µå™¨äº¤äº’ã€‚

1. åœ¨ `ADC` ç±»çš„å£°æ˜ä¸‹æ–¹æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä»¥åˆ›å»ºä¸€ä¸ª `GroveRelay` å®ä¾‹ï¼š

    ```python
    relay = GroveRelay(5)
    ```

    è¿™å°†åœ¨ Pin **5** ä¸Šåˆ›å»ºä¸€ä¸ªç»§ç”µå™¨ï¼Œè¿™æ˜¯æ‚¨è¿æ¥ç»§ç”µå™¨çš„å¼•è„šã€‚

1. ä¸ºæµ‹è¯•ç»§ç”µå™¨æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œåœ¨ `while True:` å¾ªç¯ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

    ```python
    relay.on()
    time.sleep(.5)
    relay.off()
    ```

    ä»£ç å°†ç»§ç”µå™¨æ‰“å¼€ï¼Œç­‰å¾… 0.5 ç§’ï¼Œç„¶åå…³é—­ç»§ç”µå™¨ã€‚

1. è¿è¡Œ Python åº”ç”¨ã€‚ç»§ç”µå™¨å°†æ¯ 10 ç§’æ‰“å¼€å’Œå…³é—­ä¸€æ¬¡ï¼Œæ‰“å¼€å’Œå…³é—­ä¹‹é—´æœ‰åŠç§’çš„å»¶è¿Ÿã€‚æ‚¨å°†åœ¨ CounterFit åº”ç”¨ä¸­çœ‹åˆ°è™šæ‹Ÿç»§ç”µå™¨éšç€ç»§ç”µå™¨çš„æ‰“å¼€å’Œå…³é—­è€Œé—­åˆå’Œæ–­å¼€ã€‚


## æ ¹æ®åœŸå£¤æ¹¿åº¦æ§åˆ¶ç»§ç”µå™¨

ç°åœ¨ç»§ç”µå™¨å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼Œå¯ä»¥æ ¹æ®åœŸå£¤æ¹¿åº¦è¯»æ•°æ¥æ§åˆ¶å®ƒã€‚

### ä»»åŠ¡

æ§åˆ¶ç»§ç”µå™¨ã€‚

1. åˆ é™¤æ‚¨æ·»åŠ çš„ç”¨äºæµ‹è¯•ç»§ç”µå™¨çš„ 3 è¡Œä»£ç ã€‚ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢å®ƒä»¬ï¼š

    ```python
    if soil_moisture > 450:
        print("Soil Moisture is too low, turning relay on.")
        relay.on()
    else:
        print("Soil Moisture is ok, turning relay off.")
        relay.off()
    ```

    æ­¤ä»£ç ä»åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æ£€æŸ¥åœŸå£¤æ¹¿åº¦æ°´å¹³ã€‚å¦‚æœæ¹¿åº¦å€¼é«˜äº 450ï¼Œåˆ™æ‰“å¼€ç»§ç”µå™¨ï¼›å¦‚æœä½äº 450ï¼Œåˆ™å…³é—­ç»§ç”µå™¨ã€‚

    > ğŸ’ è¯·è®°ä½ï¼Œç”µå®¹å¼åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨çš„è¯»æ•°è¶Šä½ï¼ŒåœŸå£¤ä¸­çš„æ¹¿åº¦è¶Šé«˜ï¼Œåä¹‹äº¦ç„¶ã€‚

1. è¿è¡Œ Python åº”ç”¨ã€‚æ‚¨å°†çœ‹åˆ°ç»§ç”µå™¨æ ¹æ®åœŸå£¤æ¹¿åº¦æ°´å¹³æ‰“å¼€æˆ–å…³é—­ã€‚æ›´æ”¹åœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨çš„ *Value* æˆ– *Random* è®¾ç½®ä»¥æŸ¥çœ‹å€¼å˜åŒ–ã€‚

    ```text
    Soil Moisture: 638
    Soil Moisture is too low, turning relay on.
    Soil Moisture: 452
    Soil Moisture is too low, turning relay on.
    Soil Moisture: 347
    Soil Moisture is ok, turning relay off.
    ```

> ğŸ’ æ‚¨å¯ä»¥åœ¨ [code-relay/virtual-device](../../../../../2-farm/lessons/3-automated-plant-watering/code-relay/virtual-device) æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ­¤ä»£ç ã€‚

ğŸ˜€ æ­å–œï¼æ‚¨çš„è™šæ‹ŸåœŸå£¤æ¹¿åº¦ä¼ æ„Ÿå™¨æˆåŠŸæ§åˆ¶äº†ç»§ç”µå™¨ç¨‹åºï¼
